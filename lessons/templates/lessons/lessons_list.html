{% extends 'base.html' %}

{% block content %}

<a href="{% url 'lesson_add' %}">Add lesson</a>

<div>Today is: {% now 'm/d/Y' %}</div>


<ul>
  {% for date in dates %}
  <li>
    <button data-target-date="{{ date|date:'m/d/Y' }}">{{ date|date:'m/d/Y'}}</button>
  </li>
  {% endfor %}
</ul>
<h3>Search by date</h3>

<input id="schedule-by-date" value="schedule_date"></input>
<input type="submit" value="search">





{% for lesson in lessons %}

<div data-date="{{ lesson.date|date:'m/d/Y' }}">
  {{ lesson.date|date:'m/d/Y' }}
  {{ lesson.get_time }}
  {{ lesson.get_subject }}


  {% for teacher in lesson.get_teachers %}
  <a href="{% url 'user_profile' username=teacher.user.username %}">
    {{ teacher.user.first_name }}
    {{ teacher.user.last_name }}
  </a>

  {% endfor %}


  {% for student in lesson.get_students %}
  <a href="{% url 'student_detail' pk=student.pk %}">
    {{ student.first_name }}
    {{ student.last_name }}
  </a>

  {% endfor %}
  <a href="{% url 'lesson_edit' pk=lesson.pk %}">Edit lesson</a>
  <a href="{% url 'lesson_delete' pk=lesson.pk %}">Delete lesson</a>



</div>


{% endfor %}


<script src="https://code.jquery.com/jquery-3.6.0.js"></script>
<script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
<link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
<script>
  const lessons = document.querySelectorAll('div[data-date]');
  lessons.forEach(function (lesson) {
    lesson.style.display = 'none';
  });

  $(function () {
    $('#schedule-by-date').datepicker({
      dateFormat: 'mm/dd/yy',
      onSelect: function (dateText, inst) {
        let lessonsToday = document.querySelectorAll('[data-date="' + dateText + '"]');
        for (let lesson of lessons) {
          lesson.style.display = 'none';
        }
        for (let lesson of lessonsToday) {
          lesson.style.display = 'block';
        }
      }
    });

  });



</script>

{% endblock %}